services:
  workstation:
    build:
      context: .
      secrets:
        - git_config
      args:
        ORGS_TO_CLONE: "privateerproj revanite-io gemaraproj"
        REPOS_TO_CLONE: "finos/technical-oversight-committee finos/common-cloud-controls"

    container_name: daily_workstation
    stdin_open: true
    tty: true

    pre_stop:
      - command: /cleanup_container.sh

    volumes:
      - ~/.ssh:/home/developer/.ssh:ro
      - ./dev:/home/developer/dev
      - ./bin:/workstation-bin
      - go-volume:/home/developer/go
      - downloads-volume:/home/developer/Downloads

    environment:
      - GOPATH=/home/developer/go
    networks:
      - dev-network

networks:
  dev-network:
    driver: bridge

secrets:
  git_config:
    file: ~/.gitconfig

volumes:
  go-volume:
  downloads-volume:
